-- Generated by Oracle SQL Developer Data Modeler 21.2.0.183.1957
--   at:        2022-05-28 16:24:53 CEST
--   site:      SQL Server 2012
--   type:      SQL Server 2012

DROP TABLE IF EXISTS Sprzedaz
DROP TABLE IF EXISTS Oferta_dealera
DROP TABLE IF EXISTS samochod_wyposaz
DROP TABLE IF EXISTS Dodatkowe_wyposazenie
DROP TABLE IF EXISTS Ciezarowy
DROP TABLE IF EXISTS Osobowy
DROP TABLE IF EXISTS Samochod
DROP TABLE IF EXISTS Silnik_modelu
DROP TABLE IF EXISTS Model
DROP TABLE IF EXISTS Dealer
DROP TABLE IF EXISTS Klient
DROP TABLE IF EXISTS Marka
DROP TABLE IF EXISTS Typ_silnika

CREATE TABLE Dealer 
    (
     Nazwa VARCHAR (30) CONSTRAINT Dealer_PK PRIMARY KEY , 
     Adres VARCHAR (30) NOT NULL 
    )
GO

CREATE TABLE Marka 
    (
     Nazwa VARCHAR(30) CONSTRAINT Marka_PK PRIMARY KEY, 
     Rok_zalozenia VARCHAR (30) NOT NULL 
    )
GO

CREATE TABLE Model 
    (
     id INTEGER CONSTRAINT Model_PK PRIMARY KEY , 
     Nazwa VARCHAR (30) NOT NULL , 
     Rok_wprowadzania INTEGER NOT NULL , 
     Marka_Nazwa VARCHAR (30) CONSTRAINT Model_Marka_FK REFERENCES Marka(Nazwa),  
     Nast_Generacja INTEGER CONSTRAINT Nast_Generacja_FK REFERENCES Model(id) NULL
     )
GO 

CREATE UNIQUE INDEX 
    Generacja__IDX ON Model 
    ( 
     Nast_Generacja 
    )
    WHERE Nast_Generacja IS NOT NULL
GO

CREATE TABLE Osobowy 
    (
     Liczba_pasazerow INTEGER NOT NULL , 
     Pojemnosc_bagaznika INTEGER NOT NULL , 
     Model_id INTEGER CONSTRAINT Model_osobowy_FK REFERENCES Model(id),
     CONSTRAINT Model_osobowy_PK PRIMARY KEY (Model_id)
    )
GO 

CREATE TABLE Ciezarowy 
    (
     Ladownosc INTEGER NOT NULL , 
     Model_id INTEGER CONSTRAINT Model_ciezarowy_FK REFERENCES Model(id),
     CONSTRAINT Model_ciezarowy_PK PRIMARY KEY (Model_id)
    )
GO 

CREATE TABLE Oferta_dealera
    (
     Dealer_Nazwa VARCHAR (30) CONSTRAINT dealer_model_Dealer_FK REFERENCES Dealer(Nazwa) ,
     Model_id INTEGER CONSTRAINT dealer_model_Model_FK REFERENCES Model(id) ,
     CONSTRAINT dealer_model_PK PRIMARY KEY (Dealer_Nazwa, Model_id)   
     )
 GO

CREATE TABLE Dodatkowe_wyposazenie 
    (
     Nazwa VARCHAR (30) CONSTRAINT Dodatkowe_wyposazenie_PK PRIMARY KEY
    )
GO

CREATE TABLE Klient 
    (
     id INTEGER CONSTRAINT Klient_PK PRIMARY KEY, 
     Imie VARCHAR (30) NOT NULL , 
     Nazwisko VARCHAR (30) NOT NULL , 
     Numer_telefonu INTEGER NOT NULL 
    )
GO

CREATE TABLE Silnik_modelu 
    (
     Model_id INTEGER NOT NULL, 
     Typ_silnika_id INTEGER NOT NULL,
     CONSTRAINT Silnik_modelu_PK PRIMARY KEY (Model_id, Typ_silnika_id)
    )
GO

CREATE TABLE Typ_silnika
    (
     id INTEGER CONSTRAINT Typ_silnika_PK PRIMARY KEY, 
     Rodzaj_paliwa VARCHAR (30) NOT NULL , 
     Opis_parametrow VARCHAR (30) , 
    )
GO

CREATE TABLE Samochod 
    (
     VIN bigint CONSTRAINT Samochod_PK PRIMARY KEY, 
     Przebieg INTEGER NOT NULL , 
     Skrzynia_biegow VARCHAR (30) NOT NULL , 
     Kraj_pochodzenia VARCHAR (30) NOT NULL , 
     Rok_produkcji INTEGER NOT NULL , 
     Model_id INTEGER CONSTRAINT Samochod_Model_FK REFERENCES Model(id) NOT NULL , 
     Dealer_Nazwa VARCHAR (30) CONSTRAINT Samochod_Dealer_FK REFERENCES Dealer(Nazwa) NOT NULL,
     Typ_silnika_id INTEGER CONSTRAINT Samochod_Typ_silnika_FK REFERENCES Typ_silnika(id) NOT NULL
    )
GO

CREATE TABLE samochod_wyposaz 
    (
     Samochod_VIN bigint NOT NULL, 
     Dodatkowe_wyposazenie_Nazwa VARCHAR (30) Not null,
     CONSTRAINT samochod_wyposaz_PK PRIMARY KEY(Samochod_VIN, Dodatkowe_wyposazenie_Nazwa)
    )
GO

CREATE TABLE Sprzedaz 
    (
     Data DATETIME NOT NULL , 
     Cena INTEGER NOT NULL , 
     Klient_id INTEGER CONSTRAINT Sprzedaz_Klient_id_FK REFERENCES Klient(id),
     Samochod_VIN bigint CONSTRAINT Sprzedaz_Samochod_VIN_FK REFERENCES Samochod(VIN),  
     Dealer_Nazwa VARCHAR (30) CONSTRAINT Sprzedaz_Dealer_Nazwa_FK REFERENCES Dealer(Nazwa),
     CONSTRAINT Sprzedaz_PK PRIMARY KEY (Klient_id, Samochod_VIN, Dealer_Nazwa)
    )
GO

INSERT INTO Marka VALUES
('KIA', 1944),
('Toyota', 1933),
('Opel', 1862),
('Hyundai', 1967)

INSERT INTO Klient VALUES
(1, 'Jan', 'Kowalski', 695844399),
(2, 'Anna', 'Lewandowska', 493920400),
(3, 'Tadeusz', 'Morawiecki', 394898098)

INSERT INTO Model VALUES
(1, 'Rio', 2017, 'Kia', null),
(2, 'Camry', 2017, 'Toyota', null),
(3, 'Combo Cargo',2020, 'Opel', null),
(4, 'i10', 2007, 'Hyundai', 5),
(5, 'i10', 2013, 'Hyundai', null)

INSERT INTO Dealer VALUES
('Dealer Kia', 'ul.Glowna, 44'),
('Dealer Toyota', 'ul.Wolna, 33'),
('Dealer Opel', 'ul.Lubelska, 22'),
('Dealer Hyundai', 'ul.Polna, 11')

INSERT INTO Typ_silnika VALUES
(1, 'benzyna', '1.4 120KM'),
(2, 'benzyna', '3.5 268KM'),
(3, 'diesel', '1.6 75KM'),
(4, 'benzyna', '1.0 66KM')

INSERT INTO Samochod VALUES
(38392382903303, 50000, 'manualna', 'Francja', 2018, 1, 'Dealer Kia',1),
(75843939329393, 20000, 'automatyczna', 'Niemcy', 2019, 2, 'Dealer Toyota', 2),
(43742807087499, 23000, 'manualna', 'Niemcy', 2021, 3, 'Dealer Opel', 3),
(83438293832098, 1000, 'manualna', 'Korea', 2021, 4, 'Dealer Hyundai', 4)

INSERT INTO Dodatkowe_wyposazenie VALUES
('Ogrzewanie postojowe')

INSERT INTO samochod_wyposaz VALUES
(38392382903303, 'Ogrzewanie postojowe'),
(83438293832098, 'Ogrzewanie postojowe')

INSERT INTO Osobowy VALUES
(5, 300, 1),
(5, 400, 3),
(5, 200, 4)

INSERT INTO Ciezarowy VALUES
(1000, 3)

INSERT INTO Sprzedaz VALUES
(09-10-2021, 25000,1,38392382903303,'Dealer Kia'),
(17-11-2021, 130000, 2, 75843939329393, 'Dealer Toyota')

INSERT INTO Oferta_dealera VALUES
('Dealer Kia', 1),
('Dealer Toyota',2),
('Dealer Opel', 3),
('Dealer Hyundai',4)

INSERT INTO Silnik_modelu VALUES
(1,1), 
(2,2),
(3,3),
(4,4);
 
 
 SELECT * FROM Marka;
 SELECT * FROM Model;
 SELECT * FROM Ciezarowy;
 SELECT * FROM Silnik_modelu;
 SELECT * FROM Oferta_dealera;
 SELECT * FROM Osobowy;
 SELECT * FROM Samochod;
 SELECT * FROM samochod_wyposaz;
 SELECT * FROM Dealer;
 SELECT * FROM Sprzedaz;
 SELECT * FROM Klient;
 SELECT * FROM Dodatkowe_wyposazenie;
 SELECT * FROM Typ_silnika;